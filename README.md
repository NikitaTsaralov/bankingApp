# Система транзакций

## ТЗ:

Реализовать систему транзакций. Она должна:
* принимать запросы на ввод или вывод денег и заносить их в базу данных. 
* отдавать данные по транзакции из бд при запросе инфы по какой-либо транзакции.

## Задания

1. Необходимо реализовать http api для внешних потребителей, которые и будут создавать транзакции и просить информацию о них. Как именно будет выглядеть публичный интерфейс - ваше дело. 

> Оцениваться он будет по удобству, понятности, предсказуемости и прочим вещам, которые мы все любим.

2. Система должна быть доступной и отказоустойчивой, способной жить под высокой нагрузкой - запросы на создание транзакций должны всегда выполнятся рано или поздно, то есть если что-то в сервисе упадёт из-за какого-либо nil pointerа, клиенты не должны терять способность создавать заявки на создание транзакций. Как это реализовать - ваше дело. Рекомендуем использовать брокер сообщений. 

> Ваше решение будет оцениваться по критериям понятности и поддерживаемости - гипотетические члены вашей команды не должны тратить лишнее время на расшифровку вашего замысла, исследуя вашу архитектуру или читая ваш код.

### Обязательно:
* Необходимо использовать postgresql в качестве бд.
* Если у вас будет несколько сервисов, которые общаются друг с другом, они _должны_ общаться по grpc.
* Если будете использовать брокер сообщений, рекомендуем rabbitmq - с ним намного легче начать работать, чем с кафкой.

### Дополнительно: 
* Плюсом будет openapi описание вашего публичного api.
* Также плюсом будет простой compose-файл для всей инфры

# TODOs if time (small fixes):

1. Fix log volume in rabbit
2. Tests from config files
3. Transaction types in config
4. Fix tests (test depend on each other)
5. Logger to zap
6. Migration create sql script

# TODOs must

1. foreign keys
2. migration in dockerfile

# Testing manual helpers:

```
pip install pgcli
pgcli -h 127.0.0.1 -p 5432 -U postgres -W postgres -d auth_db
```

# Setup

1. Drop tables
```
psql -h localhost -d auth_db -U postgres -p 5432 -a -q -f migrations/01_create_initial_tables.down.sql 
```